# csp554-assignment-7-solved
**TO GET THIS SOLUTION VISIT:** [CSP554 Assignment #7 Solved](https://www.ankitcodinghub.com/product/csp554-big-12/)


---

üì© **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
üì± **WhatsApp:** +1 419 877 7882  
üìÑ **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;123498&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;1&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;5&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;5\/5 - (1 vote)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;CSP554 Assignment #7 Solved&quot;,&quot;width&quot;:&quot;138&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 138px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            5/5 - (1 vote)    </div>
    </div>
Assignment #7

Worth: 12 points (2 points for each problem)

Some basic notes:

‚Ä¢ We will again be using files generated by the program TestDataGen. But even though the files this program generates end is the ‚Äò.txt‚Äô suffix, I want you to treat them as if they were (comma separated) ‚Äò.csv‚Äô files.

‚Ä¢ In fact, if you like, when you copy them to HDFS you can change their suffixes from ‚Äò.txt‚Äô to ‚Äò.csv‚Äô. But this is not necessary to complete the exercises.

Demos

To sets of demo files have been included in this assignment. It is a good idea to look at and execute them before trying the following exercises.

1. One set of demo files provide examples of the use of RDDs. The instructions are in pydemo.txt and the demo files themselves are in pyspark.zip. Use scp to copy pyspark.zip to your EMR master node (to /home/hadoop) and then follow the steps in pydemo.txt

2. Another set of demo files provide examples of the use of DataFrames. The instructions are in dfdemo.txt and the demo files themselves are in sparkdf.zip. Use scp to copy sparkdf.zip to your EMR master node (to /home/hadoop) and then follow the steps in dfdemo.txt

Exercise 1)

Step A

Start up a Hadoop cluster as previously, but instead of choosing the ‚ÄúCore Hadoop‚Äù configuration chose the ‚ÄúSpark‚Äù configuration (see below), otherwise proceed as before.

Step B

Use the TestDataGen program from previous assignments to generate new data files.

Copy both generated files to the HDFS directory ‚Äú/user/hadoop‚Äù

Step C

Load the ‚Äòfoodratings‚Äô file as a ‚Äòcsv‚Äô file into a DataFrame called foodratings. When doing so specify a schema having fields of the following names and types:

Field Name Field Type

name String

food1 Integer

food2 Integer

food3 Integer

food4 Integer

placeid Integer

As the results of this exercise provide the magic number, the code you execute and screen shots of the following commands:

foodratings.printSchema() foodratings.show(5) Exercise 2)

Load the ‚Äòfoodplaces‚Äô file as a ‚Äòcsv‚Äô file into a DataFrame called foodplaces. When doing so specify a schema having fields of the following names and types:

Field Nampee Field Type

placeid Integer

placename String

As the results of this exercise provide the code you execute and screen shots of the following commands:

foodratings.printSchema() foodratings.show(5)

Exercise 3)

Step A

Register the DataFrames created in exercise 1 and 2 as tables called ‚ÄúfoodratingsT‚Äù and ‚ÄúfoodplacesT‚Äù Step B

Use a SQL query on the table ‚ÄúfoodratingsT‚Äù to create a new DataFrame called foodratings_ex3a holding records which meet the following condition: food2 &lt; 25 and food4 &gt; 40. Remember, when defining conditions in your code use maximum parentheses.

As the results of this step provide the code you execute and screen shots of the following commands: foodratings_ex3a.printSchema() foodratings_ex3a.show(5)

Step C

Use a SQL query on the table ‚ÄúfoodplacesT‚Äù to create a new DataFrame called foodplaces_ex3b holding records which meet the following condition: placeid &gt; 3

As the results of this step provide the code you execute and screen shots of the following commands: foodplaces_ex3b.printSchema() foodplaces_ex3b.show(5)

Exercise 4)

Use a transformation (not a SparkSQL query) on the DataFrame ‚Äòfoodratings‚Äô created in exercise 1 to create a new DataFrame called foodratings_ex4 that includes only those records (rows) where the ‚Äòname‚Äô field is ‚ÄúMel‚Äù and food3 &lt; 25.

As the results of this step provide the code you execute and screen shots of the following commands: foodratings_ex4.printSchema() foodratings_ex4.show(5)

Exercise 5)

Use a transformation (not a SparkSQL query) on the DataFrame ‚Äòfoodratings‚Äô created in exercise 1 to create a new DataFrame called foodratings_ex5 that includes only the columns (fields) ‚Äòname‚Äô and ‚Äòplaceid‚Äô

As the results of this step provide the code you execute and screen shots of the following commands: foodratings_ex5.printSchema() foodratings_ex5.show(5)

Exercise 6)

Use a transformation (not a SparkSQL query) to create a new DataFrame called ex6 which is the inner join, on placeid, of the DataFrames ‚Äòfoodratings‚Äô and ‚Äòfoodplaces‚Äô created in exercises 1 and 2 As the results of this step provide the code you execute and screen shots of the following commands: ex6.printSchema() ex6.show(5)
